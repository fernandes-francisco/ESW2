@{
    ViewData["Title"] = "Atualizar para Administrador";
    ViewData["HideNavbar"] = true;
}

<style>
    html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        background-color: #f8f9fa; /* Fundo leve para destacar o card */
        overflow: hidden;
    }

    /* Estilo para a barra azul no topo */
    .top-bar {
        width: 100%;
        height: 60px; /* Altura da barra */
        background-color: #0d6efd; /* Azul do Bootstrap (cor da aplicação) */
        display: flex;
        align-items: center;
        padding: 0 24px; /* Espaçamento interno */
        position: fixed; /* Fixa a barra no topo */
        top: 0;
        left: 0;
        z-index: 1000; /* Garante que a barra fique acima do card */
        box-shadow: 0 2px 6px rgba(0,0,0,0.04);
    }

    .hamburger-btn {
        background: none;
        border: none;
        margin-right: 18px;
        padding: 8px 10px 8px 0;
        display: flex;
        align-items: center;
        cursor: pointer;
    }

    .hamburger-btn:focus {
        outline: none;
    }

    .hamburger-icon {
        width: 28px;
        height: 28px;
        display: block;
    }

    .top-bar img {
        height: 44px; /* Altura do logotipo ajustada para consistência */
        width: auto; /* Mantém proporção */
        display: block;
    }

    /* Ajuste para o conteúdo principal não ser coberto pela barra fixa */
    .main-content {
        margin-top: 60px; /* Espaço para a barra */
        height: calc(100vh - 60px); /* Ajusta a altura do conteúdo */
    }

    .login-card {
        width: 100%;
        max-width: 900px; /* Largura aumentada para 900px */
        height: 550px; /* Altura aumentada para 550px */
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        display: flex;
    }

    .image-section {
        width: 50%;
        background-image: url('https://static.vecteezy.com/system/resources/previews/003/689/228/non_2x/online-registration-or-sign-up-login-for-account-on-smartphone-app-user-interface-with-secure-password-mobile-application-for-ui-web-banner-access-cartoon-people-illustration-vector.jpg');
        background-size: cover;
        background-position: center;
    }

    .form-section {
        width: 50%;
        padding: 2.5rem; /* Aumentado para 2.5rem para mais espaço interno */
        background-color: #ffffff;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .password-wrapper {
        position: relative;
    }

    .password-wrapper .form-control {
        padding-right: 40px; /* Espaço para o ícone */
    }

    .password-toggle {
        position: absolute;
        right: 10px;
        top: 43%;
        transform: translateY(-50%);
        cursor: pointer;
        color: #6c757d;
        background: none;
        border: none;
        padding: 0;
        font-size: 1.2rem;
        z-index: 1;
    }

    .password-toggle:hover {
        color: #2c3e50;
    }

    /* Estilo para campo readonly (cinzento para indicar que não é editável) */
    .form-control[readonly] {
        background-color: #e9ecef; /* Cinzento claro */
        cursor: not-allowed; /* Cursor indicando que não é editável */
        opacity: 0.8; /* Leve transparência para reforçar visualmente */
    }

    /* Estilos para o menu lateral estilizado */
    .offcanvas-header {
        border-bottom: 1px solid #e9ecef;
        padding-bottom: 0.7rem;
        padding-top: 1.2rem;
    }

    .menu-links .nav-link {
        color: #0d6efd;
        border-radius: 8px;
        transition: background 0.15s, color 0.15s;
        padding: 12px 16px;
        font-size: 1.12rem;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .menu-links .nav-link:hover, .menu-links .nav-link.active {
        background: #e7f1ff;
        color: #084298;
        text-decoration: none;
    }

    .menu-links .nav-link.text-success {
        color: #198754;
    }

    .menu-links .nav-link.text-success:hover {
        background: #e9fbe7;
        color: #146c43;
    }

    .btn-logout {
        font-size: 1.1rem;
        padding: 12px 0;
        margin-top: 2.5rem;
        border-radius: 8px;
        font-weight: 500;
    }

    .offcanvas-body {
        padding-top: 2rem !important;
    }
</style>

<!-- Inclua o Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />

<!-- Barra azul com botão hamburger e logotipo -->
<div class="top-bar">
    <button class="hamburger-btn" type="button" data-bs-toggle="offcanvas" data-bs-target="#sideMenu" aria-controls="sideMenu" aria-label="Abrir menu">
        <!-- Ícone hamburger SVG -->
        <svg class="hamburger-icon" viewBox="0 0 100 80" fill="#fff">
            <rect width="100" height="14" rx="6"></rect>
            <rect y="33" width="100" height="14" rx="6"></rect>
            <rect y="66" width="100" height="14" rx="6"></rect>
        </svg>
    </button>
    <img src="/ativoslogo.png" alt="Logotipo Ativos360" />
</div>

<!-- Menu lateral (offcanvas) incluído diretamente na página, sem logotipo nem nome no topo -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="sideMenu" aria-labelledby="sideMenuLabel">
    <div class="offcanvas-header">
        <button type="button" class="btn-close ms-auto" data-bs-dismiss="offcanvas" aria-label="Fechar"></button>
    </div>
    <div class="offcanvas-body px-4">
        <ul class="nav flex-column menu-links">
            <li class="nav-item mb-2">
                <a class="nav-link" asp-controller="Cliente" asp-action="Index">
                    <i class="bi bi-house-door"></i>Painel do Cliente
                </a>
            </li>
            <li class="nav-item mb-2">
                <a class="nav-link" asp-controller="AtivoFinanceiro" asp-action="Index">
                    <i class="bi bi-wallet2"></i>Os Meus Ativos
                </a>
            </li>
            <li class="nav-item mb-2">
                <a class="nav-link" asp-controller="AtivoFinanceiro" asp-action="Create">
                    <i class="bi bi-plus-circle"></i>Adicionar Ativo
                </a>
            </li>
            <li class="nav-item mb-2">
                <a class="nav-link" asp-controller="Cliente" asp-action="Perfil">
                    <i class="bi bi-person"></i>Perfil
                </a>
            </li>
            @if (User.Identity.IsAuthenticated && !User.IsInRole("Admin"))
            {
                <li class="nav-item mb-2">
                    <a class="nav-link text-success" asp-controller="Account" asp-action="UpgradeToAdmin">
                        <i class="bi bi-shield-lock"></i>Tornar-se Administrador
                    </a>
                </li>
            }
        </ul>
        <form method="post" asp-controller="Account" asp-action="Logout">
            <button type="submit" class="btn btn-danger btn-logout w-100 mt-4">
                <i class="bi bi-box-arrow-right me-2"></i>Terminar Sessão
            </button>
        </form>
    </div>
</div>

<!-- Conteúdo principal ajustado para a barra -->
<div class="main-content d-flex justify-content-center align-items-center">
    <div class="login-card">
        <div class="image-section"></div>
        <div class="form-section">
            <h3 class="text-center mb-4">Atualizar para Administrador</h3>
            <div class="text-muted mb-4 text-justify">
                <p>
                    <strong>Aviso:</strong> Os administradores precisam de utilizar a palavra-passe específica disponibilizada pela equipa.
                </p>
            </div>

            @if (!string.IsNullOrEmpty(ViewBag.SuccessMessage))
            {
                <div class="alert alert-success mb-3 text-center">@ViewBag.SuccessMessage</div>
            }

            @if (!string.IsNullOrEmpty(ViewBag.ErrorMessage))
            {
                <div class="alert alert-danger mb-3 text-center">@ViewBag.ErrorMessage</div>
            }

            <form method="post" asp-controller="Account" asp-action="UpgradeToAdmin">
                <div class="mb-3">
                    <label class="form-label">Nome de utilizador</label>
                    <input type="text" name="username" class="form-control" value="@User.Identity.Name" readonly required />
                </div>
                <div class="mb-3 password-wrapper">
                    <label class="form-label">Palavra-passe</label>
                    <input type="password" id="password" name="adminPassword" class="form-control" required />
                    <i class="bi bi-eye password-toggle" id="togglePassword" onclick="togglePasswordVisibility()"></i>
                </div>
                <button type="submit" class="btn btn-primary w-100">Atualizar</button>
            </form>
        </div>
    </div>
</div>

<!-- Script para alternar a visibilidade da senha -->
<script>
    function togglePasswordVisibility() {
        const passwordInput = document.getElementById("password");
        const toggleIcon = document.getElementById("togglePassword");

        if (passwordInput.type === "password") {
            passwordInput.type = "text";
            toggleIcon.classList.remove("bi-eye");
            toggleIcon.classList.add("bi-eye-slash");
        } else {
            passwordInput.type = "password";
            toggleIcon.classList.remove("bi-eye-slash");
            toggleIcon.classList.add("bi-eye");
        }
    }
</script>

<!-- Script do Bootstrap para funcionalidades como offcanvas -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
